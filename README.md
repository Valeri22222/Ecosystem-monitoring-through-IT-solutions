# Мониторинг экосистемы через IT-решения: Оценка эффективности модели для классификации изображений лесных пожаров
## Проектная практика

## Описание проекта:

Данный проект посвящен оценке эффективности предобученной модели vit-fire-detection для классификации изображений на предмет наличия лесных пожаров. Целью является не только технический анализ производительности модели, но и бизнес-анализ стоимостных последствий ошибок.

## Задачи проекта:

-    **Загрузка и подготовка модели:** Использование предобученной модели vit-fire-detection.
-    **Загрузка и подготовка датасета:** Использование датасета Wildfire Detection Dataset с Kaggle для тестирования модели.
-    **Применение модели:** Выполнение предсказаний для изображений из тестовой выборки.
-    **Оценка качества модели:** Использование метрик классификации (Accuracy, Precision, Recall, F1-score), статистических методов (доверительные интервалы Уилсона) и проверки статистической значимости.
-    **Бизнес-анализ матрицы ошибок:** Оценка финансовых последствий различных типов ошибок модели (False Positive и False Negative) и определение оптимального порога классификации с учетом этих затрат.
-    **Визуализация и интерпретация:** Анализ распределения ошибок по уровням уверенности и визуализация критических случаев для выявления систематических проблем.

## Модель: vit-fire-detection

**Основа:** google/vit-base-patch16-224-in21k

**Архитектура: Vision Transformer (ViT)** — модель, которая разбивает изображение на патчи 16x16 пикселей, преобразует их в векторы и обрабатывает с помощью механизма внимания для анализа глобальных связей.

**Требования к входным данным:**
  - Размер: 224×224 пикселей
 - Соотношение сторон: 1:1 (квадрат)
  - Цветовая модель: RGB (3 канала)
 - Форма данных для модели: (batch_size, 3, 224, 224)

## Датасет: Wildfire Detection Dataset
 -   Автор: busier
-    Платформа: Kaggle
-    Описание: Содержит изображения с лесными пожарами и без них, используемые для обучения и тестирования моделей детекции.

## Установка
Для воспроизведения проекта необходимо установить Python и следующие зависимости. Рекомендуется использовать виртуальное окружение.
1. Клонируйте репозиторий (если применимо) или загрузите ноутбук.
2. Установите зависимости, используя файл requirements.txt:
     ```bash
    pip install -r requirements.txt
    ```

##  Использование
Проект реализован в виде Jupyter-ноутбука (или Google Colab ноутбука), который последовательно выполняет все этапы анализа.

1.  **Запуск ноутбука:** Откройте и запустите ячейки ноутбука последовательно.
2. **Загрузка данных:** Датасет будет автоматически загружен с Kaggle с помощью kagglehub.
3.  **Предсказания модели:** Модель vit-fire-detection будет загружена и использована для предсказаний на тестовой выборке.
4. **Анализ результатов:** Ноутбук содержит секции для оценки точности, статистической значимости, анализа матрицы ошибок и бизнес-оценки стоимостных последствий.

## Ключевые выводы

-   **Высокая точность:** Модель демонстрирует общую точность около 90%, что статистически значимо лучше случайного угадывания.

-    **Доверительные интервалы:** Анализ методом Уилсона подтверждает надежность оценки точности, с узкими доверительными интервалами даже при высоком уровне доверия.

-    **Матрица ошибок:** Выявлено, что ошибки типа False Negative (пропущенные пожары) более критичны и имеют значительно более высокую гипотетическую стоимость, чем False Positive (ложные тревоги).

-   **Критические ошибки:** Обнаружена проблема, что модель совершает значительную часть ошибок с очень высокой степенью уверенности, что требует дальнейшего изучения.

## Следующие шаги

1.  **Улучшение качества модели:**
    *   **Работа над критическими ошибками:** Детальный анализ изображений, на которых модель ошибается с высокой уверенностью. Возможно, потребуется дополнительная разметка данных, более сложные методы аугментации или дообучение модели на специфических примерах.
    *   **Исследование других архитектур/ансамблирование:** Рассмотрение альтернативных моделей или их комбинаций для повышения надежности.
2.  **Расширение функционала и бизнес-анализ:**
    *   **Интеграция с другими источниками данных:** Объединение визуальных данных с метеорологическими данными или данными с датчиков для более комплексного обнаружения.
    *   **Углубленный экономический анализ:** Более детальное изучение стоимостных показателей False Positive и False Negative в различных сценариях использования.
